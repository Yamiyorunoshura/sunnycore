---
# Unified Execution Plan Template v2
# Powered by BMAD™ Core
# Apply task-specific details from the active task document.

template:
  id: task-plan-template-v2
  name: Task Execution Plan
  version: 2.0
  output:
    format: markdown
    filename: "{root}/docs/plan.md"
    title: "Execution Plan – {task_id}: {task_name}"
    note: "Disposable planning document for this task; delete after completion."

sections:
  - id: context
    title: Task Context Snapshot
    instruction: |
      Summarize the task using the authoritative task file (include goal, scope, and success criteria).
      Highlight which inputs from the task document and role command files must be consulted before execution.
      Note any upstream dependencies or prerequisite approvals specific to this task.

  - id: constraints
    title: Constraints & References
    instruction: |
      Enumerate relevant constraints from CLAUDE.md, role commands, and the task document.
      Link each constraint to the files you will review (e.g., architecture docs, requirements, knowledge base).
      Capture mandatory tools, templates, or scripts the task requires.

  - id: execution
    title: Step-by-Step Plan
    instruction: |
      Translate the task's official steps into a checklist so each line begins with "- [ ]".
      **CRITICAL: When designing the step-by-step plan, always divide complex tasks into multiple simple, atomic tasks.**
      Each task should be independently executable and testable. Break down large or multi-faceted tasks into smaller, focused subtasks.
      Within each checklist entry, capture:
        - A concise action label with the task-specific focus.
        - The expected artifact or evidence to produce.
        - The validation approach you will run (tests, approvals, reviews).
      Preserve the task document's sequence and ensure no required step is omitted.
      If a task seems complex, decompose it into 2-4 smaller tasks that can be completed independently.

  - id: validation
    title: Validation & Evidence Strategy
    instruction: |
      Detail how you will prove completion of each required validation activity for this task.
      Include testing strategies, approval checkpoints, documentation updates, and rollback considerations.
      Reference the specific files or commands you will use to gather evidence.

  - id: knowledge_updates
    title: Documentation & Knowledge Updates
    instruction: |
      Specify which permanent documents (e.g., dev notes, knowledge base, architecture files) must be updated.
      Describe the task-specific insights or metrics you will capture for future reference.
      Identify where progress logging will occur (e.g., docs/progress.md) and what importance level to use.

  - id: risks
    title: Risks & Mitigations
    instruction: |
      List task-specific risks or blockers you anticipate, tied to the task's constraints or dependencies.
      Provide mitigation and rollback plans for each risk.

  - id: dod_alignment
    title: Definition of Done Alignment
    instruction: |
      Reproduce every Definition of Done item as a checklist entry formatted "- [ ]".
      For each checklist item, include the DoD text plus the plan evidence that will satisfy it.
      State how completion will be verified prior to closing the task.
      
      **DoD Checklist Format:**
      - [ ] {DoD criterion 1} - {Evidence/verification method}
      - [ ] {DoD criterion 2} - {Evidence/verification method}
      - [ ] All tests passing (≥80% coverage) - {Test execution strategy}
      - [ ] Code meets quality standards - {Review process}
      - [ ] Development notes completed - {Documentation location}

checks:
  - id: completeness
    instruction: "Verify all sections are populated with task-specific details from the authoritative task document."
  - id: traceability
    instruction: "Ensure every step maps back to requirements, architecture, or task constraints."
  - id: atomicity
    instruction: "Confirm each step in the execution plan is atomic, testable, and can be completed independently."
  - id: evidence_plan
    instruction: "Validate that each DoD item has a clear evidence strategy and validation method."
