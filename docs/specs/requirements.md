# 需求文件

## 簡介

本文件概述了 Claude 工作流程安裝器的需求。該專案旨在創建一個類似 bmadmethod 的安裝系統，能夠透過簡單的 npm 指令將 Claude 相關的工作流程組件安裝到用戶的系統中，包括將 agents 和 commands 文件安裝到用戶目錄，以及將 sunnycore 組件安裝到當前項目根目錄。

## 需求

### 需求 1：NPM 套件安裝器

**使用者故事：** 作為開發者，我希望能夠透過簡單的 npm 指令安裝 Claude 工作流程，以便快速在我的開發環境中設置 Claude 相關工具。

#### 驗收標準

1. When 用戶執行 `npx claude-installer install` 時，Then 系統應該開始安裝流程
2. When 安裝指令執行時，Then 系統應該顯示安裝進度和狀態訊息
3. When 安裝完成時，Then 系統應該顯示成功訊息和安裝摘要
4. When 用戶在任何目錄執行安裝指令時，Then 系統應該能夠正確識別當前項目根目錄
5. When 安裝過程中發生錯誤時，Then 系統應該顯示清楚的錯誤訊息並停止安裝

### 需求 2：用戶目錄文件安裝

**使用者故事：** 作為開發者，我希望 agents 和 commands 文件能夠安裝到我的用戶目錄中，以便在所有項目中都能使用這些 Claude 工作流程組件。

#### 驗收標準

1. When 安裝器執行時，Then agents 目錄下的所有文件應該被複製到 `~/.claude/agents/` 目錄
2. When 安裝器執行時，Then commands 目錄下的所有文件應該被複製到 `~/.claude/commands/` 目錄
3. When `~/.claude/` 目錄不存在時，Then 安裝器應該自動創建該目錄
4. When 目標文件已存在時，Then 安裝器應該詢問用戶是否覆蓋或創建備份
5. When 文件複製完成時，Then 安裝器應該驗證文件完整性

### 需求 3：項目根目錄組件安裝

**使用者故事：** 作為開發者，我希望 sunnycore 組件能夠安裝到當前項目的根目錄中，以便在特定項目中使用這些工作流程組件。

#### 驗收標準

1. When 安裝器執行時，Then sunnycore 目錄下的所有內容應該被複製到當前項目根目錄
2. When 安裝器無法識別項目根目錄時，Then 應該使用當前執行目錄作為項目根目錄
3. When 項目根目錄已存在同名文件或目錄時，Then 安裝器應該詢問用戶處理方式（覆蓋、跳過、重命名）
4. When sunnycore 組件安裝完成時，Then 安裝器應該驗證目錄結構完整性
5. When 項目根目錄沒有寫入權限時，Then 安裝器應該顯示權限錯誤並提供解決建議

### 需求 4：選擇性文件安裝

**使用者故事：** 作為開發者，我希望安裝器只安裝必要的文件，以便保持我的系統整潔，避免不必要的文件污染。

#### 驗收標準

1. When 安裝器執行時，Then 只有 agents、commands 和 sunnycore 目錄中的文件會被安裝
2. When 安裝器掃描源目錄時，Then 其他文件（如 README.md、package.json 等）應該被忽略
3. When 用戶查看安裝日誌時，Then 應該清楚顯示哪些文件被安裝，哪些被跳過
4. When 安裝完成後，Then 用戶系統中不應該出現除指定目錄外的其他源文件
5. When 安裝器遇到隱藏文件或系統文件時，Then 應該自動跳過這些文件

### 需求 5：安裝狀態檢測

**使用者故事：** 作為開發者，我希望安裝器能夠檢測現有安裝狀態，以便進行增量更新或重新安裝。

#### 驗收標準

1. When 安裝器啟動時，Then 應該檢查 `~/.claude/` 目錄是否已存在
2. When 檢測到現有安裝時，Then 安裝器應該詢問用戶是否要更新、重新安裝或取消
3. When 用戶選擇更新時，Then 安裝器應該只更新有變更的文件
4. When 用戶選擇重新安裝時，Then 安裝器應該先備份現有文件再進行完整安裝
5. When 檢測到版本衝突時，Then 安裝器應該顯示版本資訊並建議適當的處理方式

### 需求 6：錯誤處理和回滾

**使用者故事：** 作為開發者，我希望當安裝過程出現問題時，系統能夠提供清楚的錯誤訊息並能夠回滾變更，以便保護我的系統不受損害。

#### 驗收標準

1. When 安裝過程中發生文件複製錯誤時，Then 系統應該停止安裝並顯示具體錯誤原因
2. When 磁盤空間不足時，Then 安裝器應該在開始前檢查並警告用戶
3. When 安裝過程被中斷時，Then 系統應該能夠清理已複製的部分文件
4. When 權限不足導致安裝失敗時，Then 系統應該提供具體的權限要求說明
5. When 用戶請求回滾時，Then 系統應該能夠恢復到安裝前的狀態

### 需求 7：跨平台兼容性

**使用者故事：** 作為使用不同操作系統的開發者，我希望安裝器能夠在我的系統上正常運作，以便無論使用什麼平台都能享受一致的安裝體驗。

#### 驗收標準

1. When 在 macOS 系統上執行時，Then 安裝器應該正確處理用戶目錄路徑
2. When 在 Windows 系統上執行時，Then 安裝器應該適應 Windows 的文件系統結構
3. When 在 Linux 系統上執行時，Then 安裝器應該遵循 Linux 的目錄慣例
4. When 處理文件路徑時，Then 安裝器應該使用跨平台的路徑處理方法
5. When 設置文件權限時，Then 安裝器應該根據不同平台設置適當的權限