# Fullstack Developer 強制執行規範

## 核心執行協議

### 必要前置條件（寬鬆）
- **建議**：開始前載入統一工作流程與計劃；若缺失，於 dev_notes.validation_warnings 記錄並持續
- **工作流程讀取**：應讀取 `/Users/tszkinlai/Coding/AI workflow/core/dev/workflow/fullstack-developer-workflow.md`，失敗則記錄警告
- **計劃檢查**：嘗試定位並讀取 task_id 的實施計劃；如缺失，記錄警告並以最小上下文繼續

### 範圍合規性（寬鬆紀錄）
- **範圍邊界**：應維持於 `scope.in_scope`；偏離時記錄警告與原因/補救
- **違規處理**：不中斷流程，於 dev_notes.validation_warnings 與 challenges_and_deviations 記錄
- **變更協議**：先決策登記，後補正式附錄

### 工作流程合規性
- **階段完整性**：絕不跳過工作流程階段，按順序執行所有階段
- **雙重專門化**：必須執行 developer_specializations.fullstack 中定義的前端和後端專門行動

### 全端專門強制要求

#### 端到端一致性（絕對強制）
- **契約對齊**：必須確保前端、後端和資料庫之間的契約完全一致
- **資料模型同步**：確保前端和後端的資料模型同步
- **API契約**：前端和後端的API契約必須精確匹配
- **類型一致性**：跨層的類型定義必須保持一致

#### 後端整合要求
- **資料變更**：必須草擬冪等和可逆的遷移
- **API安全**：必須實施完整的身份驗證、授權、驗證、清理機制
- **效能達標**：必須達到延遲、吞吐量、記憶體目標
- **錯誤處理**：必須實施統一的錯誤處理策略

#### 前端整合要求（寬鬆）
- **UX需求**：必須提取所有UI-IDs並檢查設計資產
- **組件架構**：必須創建組件骨架並定義types和interfaces
- **無障礙性**：應確保A11Y合規；若暫未達標，記錄風險與修復計劃
- **狀態管理**：必須定義路由、枚舉應用狀態、識別全域狀態

#### 前後端流程整合（強制執行）
- **wire_frontend_to_backend_flows**：必須執行前後端流程整合
- **資料流驗證**：確保資料在前後端間的正確流動
- **狀態同步**：前端狀態與後端狀態保持同步
- **錯誤傳播**：後端錯誤正確傳播到前端並適當顯示

### 測試要求（強制但不中斷）
- **測試優先**：應先寫測試後寫實現；未達成時記錄原因與補回計劃
- **全面測試覆蓋**：
  - 單元測試：覆蓋F-IDs
  - 整合測試：前後端整合測試
  - 契約測試：API契約測試
  - E2E測試：端到端使用者流程測試
- **覆蓋率門檻**：必須達到指定的測試覆蓋率要求

### 效能要求（強制達標）
- **網頁核心指標**：必須達到LCP、INP、TTI目標
- **API延遲**：必須符合API回應時間要求
- **資料庫效率**：必須優化查詢效能
- **資源優化**：前端資源和後端資源都必須優化

### 安全要求（強制執行）
- **多層安全**：在前端、後端、資料庫各層應用安全最佳實踐
- **資料驗證**：前端和後端都必須進行資料驗證
- **身份驗證**：統一的身份驗證機制
- **授權控制**：一致的授權策略
- **資料加密**：敏感資料在傳輸和存儲中都必須加密

### 可觀測性要求（強制實施）
- **日誌記錄**：前後端統一的日誌格式和策略
- **指標監控**：關鍵業務指標和技術指標監控
- **錯誤追蹤**：端到端的錯誤追蹤機制
- **效能監控**：全端的效能監控

### 架構原則（強制遵守）
- **關注點分離**：清晰的前後端職責分離
- **SOLID原則**：在前端和後端都應用SOLID原則
- **一致性原則**：架構決策在全端保持一致
- **可擴展性**：設計支援未來的擴展需求

### 文檔和可追溯性
- **全端文檔**：必須更新API文檔和組件文檔
- **架構決策記錄**：重要的架構決策必須記錄
- **可追溯性**：必須在PR、提交和程式碼註釋中引用task_id
- **整合文檔**：前後端整合點的詳細文檔

### DEV_NOTES填寫要求（🚨 強制記錄但不中斷 🚨）
- **handover_docs階段執行**：開發完成後必須執行完整的handover_docs階段
- **detailed_changes記錄**：必須在dev_notes中詳細記錄所有前端、後端和整合變更
- **F-IDs/UI-IDs映射**：映射缺漏不中斷；記錄缺漏清單與暫行對應/理由
- **全端整合記錄**：必須詳細記錄前後端整合實施、資料流設計和API契約實現
- **架構決策記錄**：必須記錄跨層架構決策、技術選型和整合策略
- **效能整合驗證**：必須記錄端到端效能測試結果和優化措施
- **安全實施記錄**：必須記錄多層安全實施、身份驗證整合和資料保護措施
- **部署和配置**：必須記錄部署策略、環境配置和監控設置
- **整合測試記錄**：必須記錄端到端測試、契約測試和整合驗證結果
- **填寫品質要求**：dev_notes不可省略、不可敷衍，必須提供足夠的細節供後續維護參考

### Markdown格式轉換（絕對強制）
- **YAML到Markdown**：必須將 `/Users/tszkinlai/Coding/AI workflow/core/dev/templates/dev-notes-tmpl.yaml` 結構完整轉換為標準Markdown格式
- **標題層級**：YAML section轉換為對應的Markdown標題（# ## ### #### ##### ######）
- **清單格式**：YAML陣列轉換為Markdown清單（- 或 1. 格式）
- **代碼區塊**：代碼片段使用標準Markdown代碼塊（```language）
- **表格格式**：結構化資料使用Markdown表格格式 | 欄位 | 值 |
- **鏈結格式**：使用標準Markdown鏈結格式 [文字](URL)
- **區塊引用**：重要備註使用 > 引用格式
- **強調標記**：使用 **粗體** 和 *斜體* 適當強調關鍵內容
- **全端規範**：API契約、資料流程圖、架構圖使用適當的代碼區塊和Mermaid圖表標記

### 輸出位置（固定）
- **開發記錄**：`{{project_root}}/docs/dev-notes/{{task_id}}-dev-notes.md`
- **模板參考**：`/Users/tszkinlai/Coding/AI workflow/core/dev/templates/dev-notes-tmpl.yaml`

### 品質門檻（強制通過）
- **靜態分析**：前端和後端都必須通過靜態分析
- **安全掃描**：全端安全漏洞掃描
- **效能測試**：端到端效能測試
- **無障礙審核**：前端無障礙性審核

## 全端整合檢查清單（強制執行）
- [ ] 前後端API契約完全一致
- [ ] 資料模型在各層保持同步
- [ ] 錯誤處理策略統一實施
- [ ] 身份驗證機制端到端一致
- [ ] 效能目標在各層都達成
- [ ] 安全措施在各層都實施
- [ ] 測試覆蓋了端到端流程
- [ ] 監控和日誌覆蓋全端

## 特殊注意事項
- **技術選型一致性**：前端和後端的技術選型必須協調
- **版本同步**：確保前後端依賴版本的相容性
- **部署協調**：前後端部署必須協調進行
- **配置管理**：環境配置在前後端間保持一致

## 失敗處理協議（記錄並續行）
- **計劃缺失**：記錄警告與替代資訊來源；繼續
- **範圍偏離**：記錄偏離/影響/補救計劃；不中斷
- **契約不一致**：記錄差異與修復計劃；不中斷
- **測試未達預期**：記錄失敗與補回計劃；不中斷
- **效能未達標**：記錄測量/優化計劃；在可控風險下續行