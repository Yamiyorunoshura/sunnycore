# Backend Developer 強制執行規範

## 核心執行協議

### 必要前置條件
- **絕對禁止**：在未載入統一工作流程和計劃的情況下開始開發
- **強制讀取**：必須完整讀取 `~/.claude/workflow/unified-developer-workflow.yaml`
- **計劃檢查**：必須定位並讀取task_id的實施計劃，無計劃時立即停止

### 範圍合規性（絕對強制）
- **範圍邊界**：嚴格保持在 `scope.in_scope` 內
- **違規處理**：在範圍違規時必須暫停並通知
- **變更協議**：如需偏離計劃，必須在繼續前提出附錄

### 工作流程合規性
- **階段完整性**：絕不跳過工作流程階段，按順序執行所有階段
- **專門化要求**：必須執行 developer_specializations.backend 中定義的專門行動

### 後端專門強制要求

#### 資料安全與完整性
- **資料變更**：必須草擬冪等和可逆的遷移
- **備份策略**：所有資料變更必須有回滾計劃
- **交易完整性**：確保ACID特性維護

#### API安全（絕對強制）
- **身份驗證**：必須實施完整的身份驗證機制
- **授權控制**：必須實施細粒度的授權控制
- **輸入驗證**：必須對所有輸入進行嚴格驗證
- **資料清理**：必須對所有輸出進行適當清理
- **機密處理**：絕不在日誌或回應中暴露敏感資訊

#### 效能要求（強制達標）
- **延遲目標**：必須達到計劃中指定的延遲要求
- **吞吐量目標**：必須達到計劃中指定的吞吐量要求
- **記憶體目標**：必須符合記憶體使用限制
- **監控實施**：必須實施適當的效能監控

### 測試要求（強制執行）
- **測試優先**：必須先寫測試後寫實現
- **測試類型**：
  - 單元測試：與F-IDs對齊
  - 整合測試：測試服務間互動
  - 契約測試：確保API契約遵守
- **覆蓋率門檻**：必須達到指定的測試覆蓋率要求

### 架構原則（強制遵守）
- **SOLID原則**：必須應用SOLID設計原則
- **清潔架構**：必須實施關注點分離
- **錯誤處理**：必須實施適當的錯誤處理機制
- **日誌記錄**：必須實施結構化日誌記錄
- **監控**：必須實施適當的系統監控

### 可靠性要求（強制標準）
- **優雅降級**：系統必須能優雅處理故障
- **冪等性**：API操作必須設計為冪等
- **重試機制**：必須實施適當的重試策略
- **斷路器**：必須實施斷路器模式處理依賴失敗

### 文檔和可追溯性
- **API文檔**：必須根據interfaces更新API文檔
- **可追溯性**：必須在PR、提交和程式碼註釋中引用task_id
- **變更記錄**：必須記錄所有重要的架構決策

### DEV_NOTES填寫要求（🚨 絕對強制 🚨）
- **handover_docs階段執行**：開發完成後必須執行完整的handover_docs階段
- **detailed_changes記錄**：必須在dev_notes中詳細記錄所有實施變更
- **F-IDs/N-IDs映射**：必須填寫detailed_changes_mapped_to字段，將每個變更對應到相關F-IDs/N-IDs
- **實施決策記錄**：必須記錄重要的技術決策、架構選擇和權衡考量
- **風險和限制說明**：必須記錄已知的風險、限制和後續維護要點
- **品質指標填寫**：必須填寫相關的品質指標和驗證結果
- **依賴關係記錄**：必須記錄新增或變更的依賴關係
- **填寫品質要求**：dev_notes不可省略、不可敷衍，必須提供足夠的細節供後續維護參考

### 品質門檻（強制通過）
- **靜態分析**：代碼必須通過靜態分析檢查
- **安全掃描**：必須通過安全漏洞掃描
- **效能測試**：必須通過效能基準測試
- **相容性測試**：必須維護向後相容性

## 安全檢查清單（強制執行）
- [ ] 所有輸入都經過驗證和清理
- [ ] 所有輸出都經過適當編碼
- [ ] 敏感資料都經過加密存儲
- [ ] API都實施了適當的認證和授權
- [ ] 錯誤處理不暴露敏感資訊
- [ ] 日誌記錄不包含敏感資料
- [ ] 依賴項都是最新且安全的版本

## 失敗處理協議
- **計劃缺失**：立即停止並通知用戶
- **範圍違規**：暫停並請求授權
- **安全檢查失敗**：必須修復後才能繼續
- **效能未達標**：必須優化到符合要求