---
template: unified-plan-validation-workflow
version: 1

# ğŸ”„ å·¥ä½œæµç¨‹Todo Listè£½ä½œæµç¨‹
todo_list_creation:
  description: "åœ¨é–‹å§‹åŸ·è¡Œä»»ä½•å·¥ä½œæµç¨‹æ­¥é©Ÿä¹‹å‰ï¼Œå¿…é ˆä½¿ç”¨todo_writeå·¥å…·å‰µå»ºåŒ…å«æ‰€æœ‰workflowæ­¥é©Ÿçš„todo list"
  importance: "critical"
  
  # ğŸ› ï¸ Todo Listå·¥å…·ä½¿ç”¨æŒ‡å—
  tool_syntax:
    format: "JSON"
    structure: |
      {
        "todos": [
          {
            "content": "å…·é«”ä»»å‹™æè¿°",
            "status": "pending|in_progress|completed",
            "id": "å”¯ä¸€è­˜åˆ¥ç¢¼",
            "priority": "high|medium|low"
          }
        ]
      }
  
  process_steps:
    1_analyze_workflow:
      description: "åˆ†æå·¥ä½œæµç¨‹çµæ§‹ - ä»”ç´°é–±è®€æ•´å€‹workflowæ–‡ä»¶ï¼Œè­˜åˆ¥æ‰€æœ‰éšæ®µã€æ­¥é©Ÿå’Œä»»å‹™"
      priority: "high"
      
    2_extract_tasks:
      description: "æå–é—œéµä»»å‹™ - å°‡æ¯å€‹éšæ®µçš„æ ¸å¿ƒä»»å‹™è½‰æ›ç‚ºå…·é«”çš„todoé …ç›®"
      priority: "high"
      
    3_set_priorities:
      description: "è¨­å®šå„ªå…ˆç´š - æ ¹æ“šä»»å‹™çš„é‡è¦æ€§å’Œä¾è³´é—œä¿‚è¨­å®šå„ªå…ˆç´š"
      priority: "medium"
      
    4_create_todo_list:
      description: "å‰µå»ºTodo List - ä½¿ç”¨todo_writeå·¥å…·å‰µå»ºåŒ…å«æ‰€æœ‰æ­¥é©Ÿçš„çµæ§‹åŒ–todo list"
      priority: "high"
      
    5_execute_workflow:
      description: "åŸ·è¡Œèˆ‡æ›´æ–° - æŒ‰ç…§todo listé †åºåŸ·è¡Œä»»å‹™ï¼ŒåŠæ™‚æ›´æ–°ç‹€æ…‹"
      priority: "high"
  
  # ğŸ“ Todo Listè¦æ±‚
  requirements:
    coverage: "æ¯å€‹ä¸»è¦éšæ®µéƒ½æ‡‰è©²æœ‰å°æ‡‰çš„todoé …ç›®"
    validation: "é—œéµçš„é©—è­‰æª¢æŸ¥é»å¿…é ˆåŒ…å«åœ¨todo listä¸­"
    priority_setting: "è¨­å®šåˆç†çš„å„ªå…ˆç´šï¼Œç¢ºä¿ä¾è³´é—œä¿‚å¾—åˆ°å°Šé‡"
    status_tracking: "åœ¨åŸ·è¡Œéç¨‹ä¸­åŠæ™‚æ›´æ–°todoç‹€æ…‹ï¼ˆpending â†’ in_progress â†’ completedï¼‰"
    uniqueness: "åŒæ™‚åªèƒ½æœ‰ä¸€å€‹ä»»å‹™è™•æ–¼in_progressç‹€æ…‹"
    completeness: "åªæœ‰åœ¨ä»»å‹™å®Œå…¨å®Œæˆæ™‚æ‰æ¨™è¨˜ç‚ºcompleted"

# åˆ†éš”ç·šï¼Œä»¥ä¸‹ç‚ºåŸå§‹workflowå…§å®¹
---

workflow:
  name: "çµ±ä¸€è¨ˆåŠƒé©—è­‰å·¥ä½œæµç¨‹"
  description: "é©—è­‰å¯¦æ–½è¨ˆåŠƒçš„å®Œæ•´æ€§ã€æ­£ç¢ºæ€§ã€ç¯„æœ¬ç¬¦åˆæ€§ï¼Œä¸¦èˆ‡å°ˆæ¡ˆè¦æ ¼äº¤å‰å¼•ç”¨çš„çµ±ä¸€å·¥ä½œæµç¨‹ã€‚"
  template_reference: "{project_root}/cursor-claude/core/po/templates/implementation-plan-tmpl.yaml"
  report_template: "{project_root}/cursor-claude/core/po/templates/plan-validation-report-tmpl.yaml"
  enforcement_level: "lenient"
  halt_on_validation_failure: false

inputs:
  task_id: "<required>"
  plan_path: "<auto>"

plan_resolution:
  find_by_task_id: true
  search_paths:
    - "{{project_root}}/docs/implementation-plan"
  supported_extensions: ["yaml", "yml", "md"]
  expectations:
    template: "implementation-plan"
    version: 1

guardrails:
  cross_reference_is_blocking: false
  on_untraceable_items: "append_warning_and_continue_as_finding"

execution_hints:
  determinism:
    preferred: true
    llm:
      temperature: 0
      top_p: 0
      frequency_penalty: 0
      presence_penalty: 0
    sorting:
      evidence: ["area", "path", "start_line"]
      findings: ["severity(desc)", "area", "path", "start_line"]
  caching:
    enabled: true
    cache_key_components: ["task_id", "plan_path", "specs_sha256"]
    invalidate_on: ["file_hash_change", "mtime_change"]
    cacheable_items:
      - plan_document_content
      - spec_documents_content
      - cross_reference_index
  concurrency:
    allow_intra_stage_parallelism: true
    max_parallelism: 4
    notes:
      - "è·¨éšæ®µä¸å¯ä¸¦è¡Œï¼›å¿…é ˆä¿æŒéšæ®µé †åºèˆ‡æª¢æŸ¥é»ã€‚"
      - "åŒä¸€éšæ®µå…§äº’ä¸ç›¸ä¾çš„è®€æª”/æª¢æŸ¥å¯ä¸¦è¡Œã€‚"

preconditions:
  - "è¨ˆåŠƒæ–‡ä»¶å­˜åœ¨ä¸”å¯è¨ªå•"
  - "æ‰€æœ‰å¼•ç”¨çš„è¦æ ¼æ–‡ä»¶å­˜åœ¨"
  - "è¨ˆåŠƒç¬¦åˆé æœŸç¯„æœ¬çµæ§‹"

# æ•´åˆçš„åŸ·è¡Œå”è­°
enforcement_protocol:
  enforcement_compliance:
    mandatory_enforcement_file: "{project_root}/cursor-claude/core/po/enforcement/implementation-plan-validator-enforcement.md"
    compliance_verification: "Verify enforcement rules are understood; record warnings on minor non-compliance and continue"
    halt_on_non_compliance: false
  
  mandatory_file_loading:
    description: "åœ¨é–‹å§‹ä»»ä½•é©—è­‰å·¥ä½œä¹‹å‰å¿…é ˆè¼‰å…¥çš„æª”æ¡ˆ"
    requirements:
      - "READ {project_root}/cursor-claude/core/po/enforcement/implementation-plan-validator-enforcement.md COMPLETELY - This file contains all mandatory rules and constraints"
      - "READ çµ±ä¸€å¯¦æ–½è¨ˆåŠƒé©—è­‰å·¥ä½œæµç¨‹ YAML æª”æ¡ˆå®Œæ•´å…§å®¹"
      - "READ å¯¦æ–½è¨ˆåŠƒç¯„æœ¬ YAML æª”æ¡ˆå®Œæ•´å…§å®¹"
      - "READ è¨ˆåŠƒé©—è­‰å ±å‘Šç¯„æœ¬ YAML æª”æ¡ˆå®Œæ•´å…§å®¹"
      - "ç¢ºèªç†è§£æ‰€æœ‰å·¥ä½œæµç¨‹éšæ®µ"
      - "ç¢ºèªç†è§£ç¯„æœ¬çµæ§‹"
      - "ç¢ºèªç†è§£é©—è­‰éœ€æ±‚"
      - "å¦‚æœä»»ä½•æª”æ¡ˆç„¡æ³•è¼‰å…¥æˆ–ç†è§£å‰‡åœæ­¢"

  plan_location_and_loading:
    plan_resolution_process:
      - "æ ¹æ“š task_id åœ¨ {{project_root}}/docs/implementation-plan/ ä¸­å®šä½è¨ˆåŠƒ"
      - "æ”¯æ´çš„å‰¯æª”åï¼š.yaml, .yml, .md"
      - "é©—è­‰è¨ˆåŠƒå­˜åœ¨ä¸”å¯è®€å–"
      - "å®Œæ•´è®€å–è¨ˆåŠƒæ–‡ä»¶"
      - "è¼‰å…¥æ‰€æœ‰è¦æ ¼æª”æ¡ˆï¼šdocs/specs/task.mdã€requirements.mdã€design.md"

  stage_execution_checkpoints:
    before_stage:
      - "èªªæ˜æ­£åœ¨é–‹å§‹çš„éšæ®µ"
      - "åƒè€ƒå·¥ä½œæµç¨‹æª”æ¡ˆä¸­çš„ç‰¹å®šéšæ®µéœ€æ±‚"
    
    during_stage:
      - "åŸ·è¡Œè©²éšæ®µåˆ—å‡ºçš„æ‰€æœ‰å‹•ä½œ"
      - "é€²è¡Œç³»çµ±æ€§åˆ†æå’Œé©—è­‰"
      - "åŸ·è¡Œæ‰€æœ‰äº¤å‰åƒè€ƒæª¢æŸ¥"
    
    after_stage:
      - "å°ç…§é©—è­‰è¦å‰‡é©—è­‰éšæ®µå®Œæˆ"
      - "ç¢ºèªæ‰€æœ‰å¿…éœ€çš„è¼¸å‡ºå·²ç”Ÿæˆ"
      - "ç”¨è­‰æ“šè¨˜éŒ„ç™¼ç¾"

  cross_reference_validation_requirements:
    schema_validation:
      - "é©—è­‰è¨ˆåŠƒä¸­æ‰€æœ‰å¿…éœ€ç« ç¯€å­˜åœ¨"
      - "æª¢æŸ¥æ¯å€‹ç« ç¯€çš„ç¯„æœ¬ç¬¦åˆæ€§"
      - "è­˜åˆ¥ä»»ä½•ç¼ºå¤±æˆ–ç©ºç™½çš„å¿…éœ€ç« ç¯€"
      - "ç”¨è­‰æ“šè¨˜éŒ„æ¶æ§‹é•è¦"
    
    cross_reference_checks:
      functional_objectives: "å°‡æ¯å€‹ç›®æ¨™è¿½æº¯åˆ° requirements.mdã€task.md æˆ– design.md"
      non_functional_targets: "é©—è­‰è¦æ ¼ä¸­å­˜åœ¨å¯æ¸¬é‡æ¨™æº–"
      scope_boundaries: "é©—è­‰ in_scope/out_of_scope èˆ‡ä»»å‹™å®šç¾©å°ç…§"
      architecture_modules: "æª¢æŸ¥æ–¹æ³•å…ƒç´ èˆ‡ design.md çš„è¿½æº¯æ€§"
      data_changes: "é©—è­‰è¨­è¨ˆæ–‡ä»¶ä¸­çš„æ¶æ§‹è®Šæ›´å’Œé·ç§»"
      test_strategy: "é©—è­‰æ¸¬è©¦æ–¹æ³•èˆ‡å°ˆæ¡ˆæ¨™æº–å°ç…§"
      dependencies: "æª¢æŸ¥ä¾è³´é—œä¿‚èˆ‡æ™‚é–“ç·šçš„ä¸€è‡´æ€§"
      dev_notes_structure: "é©—è­‰ dev_notes_location æŒ‡å‘æ­£ç¢ºè·¯å¾‘çµæ§‹"
    
    evidence_requirements:
      - "æ¯å€‹ç™¼ç¾éƒ½å¿…é ˆåŒ…å«å…·é«”è­‰æ“š"
      - "æ‰€æœ‰è²æ˜çš„æª”æ¡ˆè·¯å¾‘å’Œç« ç¯€åƒè€ƒ"
      - "å„˜å¯èƒ½æä¾›è¡Œè™Ÿä»¥ç²¾ç¢ºå¼•ç”¨"
      - "å¼•ç”¨ç›¸é—œæ–‡æœ¬ä»¥æ”¯æŒç™¼ç¾"

  template_population_enforcement:
    mandatory_steps:
      - "ç¸½æ˜¯å…ˆè®€å–ç¯„æœ¬æª”æ¡ˆå†å¯«å…¥"
      - "æŒ‰ç¯„æœ¬éœ€æ±‚é€ç« ç¯€å¡«å……"
      - "çµ•ä¸ç•™ä¸‹ä½”ä½ç¬¦æ–‡æœ¬å¦‚ {task_id}`(å¦‚`1`, `2`, `3`...) æˆ– INSERT VALUE"
      - "æ¯å€‹ç™¼ç¾éƒ½å¿…é ˆåŒ…å«å…·é«”è­‰æ“š"
      - "æä¾›å…·é«”çš„æ”¹é€²æ­¥é©Ÿ"
      - "å®Œæ•´æ€§æª¢æŸ¥ï¼šæ¯å€‹ç¯„æœ¬ç« ç¯€éƒ½å¿…é ˆå¡«å……"

  findings_and_recommendations:
    finding_documentation:
      - "å…·é«”ï¼šè­˜åˆ¥ç¼ºå¤±æˆ–ç„¡æ³•é©—è­‰çš„ç¢ºåˆ‡é …ç›®"
      - "è­‰æ“šï¼šç‚ºæ¯å€‹ç™¼ç¾æä¾›æª”æ¡ˆè·¯å¾‘å’Œå¼•ç”¨"
      - "åš´é‡æ€§ï¼šæŒ‰å°è¨ˆåŠƒå“è³ªçš„å½±éŸ¿æ’ç­‰ç´šç™¼ç¾"
      - "å¯è¿½æº¯æ€§ï¼šé¡¯ç¤ºèƒ½å¦è¿½æº¯åˆ°è¦æ ¼"
    
    recommendation_requirements:
      - "å¯è¡Œï¼šæä¾›å…·é«”çš„æ”¹é€²æ­¥é©Ÿ"
      - "å„ªå…ˆç´šï¼šæŒ‰é‡è¦æ€§å’Œå½±éŸ¿æ’åº"
      - "å¯æ¸¬é‡ï¼šå„˜å¯èƒ½åŒ…å«æˆåŠŸæ¨™æº–"
      - "ç¾å¯¦ï¼šç¢ºä¿å»ºè­°å¯è¡Œ"

  validation_checkpoints:
    after_document_generation:
      - "é‡æ–°è®€å–ç”Ÿæˆçš„æ–‡ä»¶"
      - "é€ç« ç¯€èˆ‡ç¯„æœ¬çµæ§‹æ¯”è¼ƒ"
      - "é©—è­‰æ²’æœ‰ä½”ä½ç¬¦å€¼æ®˜ç•™"
      - "ç¢ºèªæ‰€æœ‰ç™¼ç¾éƒ½æœ‰è­‰æ“šæ”¯æŒ"
      - "é©—è­‰markdownæ ¼å¼å’Œçµæ§‹"
    
    completion_criteria:
      - "æ‰€æœ‰å·¥ä½œæµç¨‹éšæ®µå·²å®Œæˆ"
      - "æ‰€æœ‰ç¯„æœ¬ç« ç¯€ç”¨å¯¦éš›å…§å®¹å¡«å……"
      - "æ‰€æœ‰é©—è­‰è¦å‰‡å·²æ»¿è¶³"
      - "æ‰€æœ‰ç™¼ç¾æœ‰è­‰æ“šæ”¯æŒ"
      - "å»ºè­°å¯è¡Œä¸”å…·é«”"
      - "æ–‡ä»¶æº–å‚™å¥½ä¾›åˆ©å®³é—œä¿‚äººå¯©æŸ¥"

  error_handling:
    validation_failures:
      - "å°‡é©—è­‰å¤±æ•—è¨˜éŒ„ç‚ºè­¦å‘Šä¸¦æŒçºŒ"
      - "è­˜åˆ¥å…·é«”é©—è­‰å¤±æ•—"
      - "è¿”å›é©ç•¶éšæ®µé€²è¡Œè£œé½Šï¼ˆéé˜»æ–·ï¼‰"
      - "ä¿®æ­£å¾Œé‡æ–°åŸ·è¡Œï¼ˆå¯å»¶å¾Œï¼‰"
      - "æ–¼æœ€çµ‚å ±å‘Šä¸­é™„ä¸Š validation_warnings"
    
    cross_reference_failures:
      - "å¦‚æœè¨ˆåŠƒé …ç›®ç„¡æ³•è¿½æº¯åˆ°è¦æ ¼ï¼Œè¨˜éŒ„ç‚ºç™¼ç¾"
      - "å¦‚æœè¦æ ¼ç¼ºå°‘è³‡è¨Šï¼Œè¨˜éŒ„ç‚ºç´„æŸ"
      - "å¦‚æœè¨ˆåŠƒåé›¢è¦æ ¼ï¼Œè¨˜éŒ„ç‚ºé¢¨éšª"

  critical_success_factors:
    - "å…ˆè®€å–å·¥ä½œæµç¨‹å’Œç¯„æœ¬æª”æ¡ˆ - çµ•ä¸åœ¨æ²’æœ‰å®ƒå€‘çš„æƒ…æ³ä¸‹é–‹å§‹"
    - "å®šä½å’Œè¼‰å…¥è¨ˆåŠƒæ–‡ä»¶ - ç¢ºä¿å­˜åœ¨ä¸”å®Œæ•´"
    - "è¼‰å…¥æ‰€æœ‰è¦æ ¼æª”æ¡ˆ - éœ€æ±‚ã€ä»»å‹™ã€è¨­è¨ˆ"
    - "ç³»çµ±æ€§åˆ†æ - å…ˆå®šç¾©é©—è­‰ç­–ç•¥"
    - "åŸ·è¡Œå¾¹åº•çš„äº¤å‰åƒè€ƒ - å°‡æ‰€æœ‰è¨ˆåŠƒå…ƒç´ è¿½æº¯åˆ°è¦æ ¼"
    - "ç”¨è­‰æ“šè¨˜éŒ„ç™¼ç¾ - æ¯å€‹è²æ˜éƒ½éœ€è¦è­‰æ˜"
    - "ç”¢ç”Ÿå¯è¡Œå»ºè­° - å…·é«”çš„æ”¹é€²æ­¥é©Ÿ"
    - "åœ¨æª¢æŸ¥é»é©—è­‰ - ç¢ºä¿æ¯éšæ®µå“è³ª"

  workflow_violation_responses:
    missing_stage_execution: "è¿”å›ä¸¦å®Œæˆè·³éçš„éšæ®µ"
    incomplete_cross_reference: "å®Œæˆæ‰€æœ‰å¯è¿½æº¯æ€§æª¢æŸ¥"
    unsupported_findings: "ç‚ºæ‰€æœ‰è²æ˜æä¾›è­‰æ“š"
    incomplete_template: "è­˜åˆ¥ç¼ºå¤±ç« ç¯€ä¸¦å¡«å……å®ƒå€‘"
    generic_recommendations: "ä½¿å»ºè­°å…·é«”ä¸”å¯è¡Œ"
    invalid_format: "ä¿®æ­£æ ¼å¼ä»¥å®Œå…¨ç¬¦åˆç¯„æœ¬"

# çµ±ä¸€éšæ®µåŸ·è¡Œæµç¨‹
stages:
  - id: "workflow_initialization"
    title: "å·¥ä½œæµç¨‹åˆå§‹åŒ–"
    description: "è¼‰å…¥å¿…è¦æ–‡ä»¶ä¸¦è¨­ç½®é©—è­‰ç’°å¢ƒ"
    completion_requirements:
      - workflow_file_parsed: true
      - template_structure_understood: true
      - validation_rules_loaded: true
    actions:
      - load_workflow_file: "{project_root}/cursor-claude/core/po/workflow/unified-plan-validation-workflow.yaml"
      - load_template_from: "{project_root}/cursor-claude/core/po/templates/implementation-plan-tmpl.yaml"
      - load_report_template: "{project_root}/cursor-claude/core/po/templates/plan-validation-report-tmpl.yaml"
      - verify_file_accessibility

  - id: "validation_strategy"
    title: "é©—è­‰ç­–ç•¥è¨­ç½®"
    description: "å»ºç«‹é©—è­‰ç­–ç•¥å’Œè¿½æº¯è¨ˆåŠƒ"
    completion_requirements:
      - validation_strategy_defined: true
      - validation_focus_areas_defined: true
      - cross_reference_strategy_established: true
    actions:
      - analyze_validation_requirements: ["schema", "objectives", "scope", "approach", "data", "testing", "timeline", "risks"]
      - define_validation_focus_areas
      - establish_cross_reference_strategy

  - id: "plan_and_spec_loading"
    title: "è¨ˆåŠƒå’Œè¦æ ¼è¼‰å…¥"
    description: "è¼‰å…¥è¨ˆåŠƒæ–‡ä»¶å’Œæ‰€æœ‰ç›¸é—œè¦æ ¼æ–‡ä»¶"
    completion_requirements:
      - plan_document_located_and_read: true
      - all_required_specs_read: true
      - cross_reference_sources_identified: true
    actions:
      - resolve_plan_by_task_id: "{{task_id}`(å¦‚`1`, `2`, `3`...)}"
      - read_specification_files: ["docs/specs/task.md", "docs/specs/requirements.md", "docs/specs/design.md"]
      - identify_cross_reference_sources
      - validate_plan_document_completeness

  - id: "schema_validation"
    title: "æ¶æ§‹å’Œç¯„æœ¬ç¬¦åˆæ€§é©—è­‰"
    description: "é©—è­‰è¨ˆåŠƒç¬¦åˆå¯¦æ–½è¨ˆåŠƒç¯„æœ¬æ¶æ§‹"
    completion_requirements:
      - template_compliance_checked: true
      - missing_required_sections_identified: true
      - schema_violations_documented: true
    actions:
      - validate_against_plan_template: "implementation-plan"
      - check_required_sections_presence
      - identify_missing_or_empty_sections
      - document_schema_violations_with_evidence

  - id: "cross_reference_validation"
    title: "äº¤å‰åƒè€ƒå’Œå¯è¿½æº¯æ€§é©—è­‰"
    description: "é©—è­‰è¨ˆåŠƒå…ƒç´ èˆ‡è¦æ ¼æ–‡ä»¶çš„å¯è¿½æº¯æ€§"
    completion_requirements:
      - functional_objectives_traced: true
      - non_functional_targets_verified: true
      - scope_boundaries_validated: true
      - approach_elements_cross_referenced: true
      - data_changes_verified: true
      - test_strategy_validated: true
      - dependencies_consistency_checked: true
    actions:
      - trace_functional_objectives_to_specs
      - verify_non_functional_targets_in_specs
      - validate_scope_boundaries_against_task_definition
      - cross_reference_approach_with_design
      - verify_data_changes_in_design_docs
      - validate_test_strategy_against_standards
      - check_dependencies_timeline_consistency
      - document_untraceable_items_as_findings

  - id: "gap_analysis"
    title: "å·®è·åˆ†æå’Œé¢¨éšªè©•ä¼°"
    description: "è­˜åˆ¥è¨ˆåŠƒä¸­çš„å·®è·ã€ä¸ä¸€è‡´å’Œé¢¨éšª"
    completion_requirements:
      - gaps_identified_and_categorized: true
      - risks_assessed_and_documented: true
      - severity_levels_assigned: true
      - evidence_linked_to_all_findings: true
    actions:
      - identify_planning_gaps_and_omissions
      - analyze_inconsistencies_between_plan_and_specs
      - assess_risks_and_assumptions
      - categorize_findings_by_severity
      - link_evidence_to_all_findings
      - prioritize_findings_by_impact

  - id: "recommendation_formulation"
    title: "å»ºè­°åˆ¶å®š"
    description: "ç‚ºè­˜åˆ¥çš„å•é¡Œåˆ¶å®šå…·é«”ä¸”å¯è¡Œçš„æ”¹é€²å»ºè­°"
    completion_requirements:
      - actionable_recommendations_developed: true
      - recommendations_prioritized: true
      - success_criteria_defined: true
      - realistic_implementation_steps_provided: true
    actions:
      - develop_specific_improvement_recommendations
      - prioritize_recommendations_by_impact_and_effort
      - define_success_criteria_for_recommendations
      - provide_realistic_implementation_steps
      - estimate_effort_and_timeline_for_improvements

  - id: "report_generation"
    title: "é©—è­‰å ±å‘Šç”Ÿæˆ"
    description: "ç”Ÿæˆçµæ§‹åŒ–çš„è¨ˆåŠƒé©—è­‰å ±å‘Š"
    completion_requirements:
      - template_structure_followed: true
      - no_placeholder_values: true
      - all_findings_supported_by_evidence: true
      - recommendations_actionable_and_specific: true
    actions:
      - load_validation_report_template: "{project_root}/cursor-claude/core/po/templates/plan-validation-report-tmpl.yaml"
      - populate_metadata_with_actual_values
      - populate_sections: [
          "metadata",
          "summary",
          "compliance_analysis",
          "cross_reference_findings",
          "gap_analysis",
          "recommendations",
          "appendix"
        ]
      - ensure_all_findings_have_evidence
      - provide_specific_actionable_recommendations
      - verify_no_placeholder_content_remains

  - id: "finalization"
    title: "å®Œæˆèˆ‡å“è³ªç¢ºèª"
    description: "æœ€çµ‚é©—è­‰å’Œå“è³ªæª¢æŸ¥"
    completion_requirements:
      - final_document_read_back: true
      - completeness_verified: true
      - template_compliance_confirmed: true
      - validation_report_ready_for_stakeholders: true
    actions:
      - self_check_against_workflow
      - read_generated_document_back
      - compare_against_template_structure
      - verify_no_placeholder_values_remain
      - confirm_all_findings_supported_by_evidence
      - validate_recommendations_are_actionable
      - validate_markdown_formatting_and_structure
      - request_feedback_if_needed

# æ•´åˆçš„é©—è­‰è¦å‰‡
validation_rules:
  template_validation:
    required_metadata_fields:
      - task_id: "actual_value_not_placeholder"
      - project_name: "actual_value_not_placeholder"
      - owner: "actual_owner_name"
      - date: "yyyy_mm_dd_format"
      - sources: "all_spec_and_plan_paths_documented"

    required_content_sections:
      - overall_assessment: "feasibility_and_completeness_summary"
      - architecture_alignment: "design_consistency_analysis"
      - requirements_alignment: "functional_non_functional_traceability"
      - gaps_and_risks: "missing_items_and_severity_assessment"
      - recommendations: "specific_actionable_improvement_steps"
      - next_steps: "priority_items_and_follow_up_actions"

    evidence_requirements:
      - findings_supported: "file_paths_line_numbers_section_references"
      - cross_references_documented: "specific_spec_locations_quoted_text"
      - gaps_specific: "exact_missing_items_and_locations"
      - recommendations_actionable: "concrete_steps_with_success_criteria"

    forbidden_content:
      - placeholder_brackets: ["<", ">"]
      - placeholder_text: ["INSERT", "TODO", "TBD"]
      - generic_placeholders: ["{task_id}`(å¦‚`1`, `2`, `3`...)", "<project_name>", "<owner>"]
      - unsupported_findings: "all_findings_must_have_evidence"
      - vague_recommendations: ["should improve", "consider enhancing", "might benefit"]

  error_handling:
    missing_stage:
      severity: "blocker"
      message: "Mandatory validation stage not completed"
      action: "halt_and_request_completion"

    incomplete_cross_reference:
      severity: "blocker"
      message: "Required cross-reference validation not completed"
      action: "halt_and_request_traceability_completion"

    unsupported_findings:
      severity: "high"
      message: "Findings made without supporting evidence"
      action: "flag_and_request_evidence"

    incomplete_template:
      severity: "high"
      message: "Template section incomplete or contains placeholders"
      action: "request_template_completion"

    generic_recommendations:
      severity: "medium"
      message: "Recommendations too generic to be actionable"
      action: "request_specific_recommendations"

output:
  path: "{{project_root}}/docs/validation-reports/"
  filename: "{{task_id}`(å¦‚`1`, `2`, `3`...)}-plan-validation.md"
  format: markdown

reporting:
  include_execution_metadata: true
  execution_metadata_fields: ["run_id", "start_time", "end_time", "stage_timings", "parallelism", "cache_stats"]
