---
template: unified-file-classification-workflow
version: 1

# ğŸ”„ å·¥ä½œæµç¨‹Todo Listè£½ä½œæµç¨‹
todo_list_creation:
  description: "åœ¨é–‹å§‹åŸ·è¡Œä»»ä½•å·¥ä½œæµç¨‹æ­¥é©Ÿä¹‹å‰ï¼ŒAIå¿…é ˆå…ˆå‰µå»ºåŒ…å«æ‰€æœ‰workflowæ­¥é©Ÿçš„todo list"
  importance: "critical"
  
  process_steps:
    1_analyze_workflow:
      description: "åˆ†æå·¥ä½œæµç¨‹çµæ§‹ - ä»”ç´°é–±è®€æ•´å€‹workflowæ–‡ä»¶ï¼Œè­˜åˆ¥æ‰€æœ‰éšæ®µã€æ­¥é©Ÿå’Œä»»å‹™"
      priority: "high"
      
    2_extract_tasks:
      description: "æå–é—œéµä»»å‹™ - å°‡æ¯å€‹éšæ®µçš„æ ¸å¿ƒä»»å‹™è½‰æ›ç‚ºå…·é«”çš„todoé …ç›®"
      priority: "high"
      
    3_set_priorities:
      description: "è¨­å®šå„ªå…ˆç´š - æ ¹æ“šä»»å‹™çš„é‡è¦æ€§å’Œä¾è³´é—œä¿‚è¨­å®šå„ªå…ˆç´šï¼ˆhigh/medium/lowï¼‰"
      priority: "medium"
      
    4_create_todo_list:
      description: "å‰µå»ºTodo List - ä½¿ç”¨todo_writeå·¥å…·å‰µå»ºåŒ…å«æ‰€æœ‰æ­¥é©Ÿçš„çµæ§‹åŒ–todo list"
      priority: "high"
      
    5_execute_workflow:
      description: "é–‹å§‹åŸ·è¡Œ - æŒ‰ç…§todo listçš„é †åºåŸ·è¡Œä»»å‹™ï¼Œä¸¦åŠæ™‚æ›´æ–°ç‹€æ…‹"
      priority: "high"
  
  requirements:
    coverage: "æ¯å€‹ä¸»è¦éšæ®µéƒ½æ‡‰è©²æœ‰å°æ‡‰çš„todoé …ç›®"
    validation: "é—œéµçš„é©—è­‰æª¢æŸ¥é»å¿…é ˆåŒ…å«åœ¨todo listä¸­"
    priority_setting: "è¨­å®šåˆç†çš„å„ªå…ˆç´šï¼Œç¢ºä¿ä¾è³´é—œä¿‚å¾—åˆ°å°Šé‡"
    status_tracking: "åœ¨åŸ·è¡Œéç¨‹ä¸­åŠæ™‚æ›´æ–°todoç‹€æ…‹ï¼ˆpending â†’ in_progress â†’ completedï¼‰"

# åˆ†éš”ç·šï¼Œä»¥ä¸‹ç‚ºåŸå§‹workflowå…§å®¹
---

workflow:
  name: "çµ±ä¸€æª”æ¡ˆåˆ†é¡å·¥ä½œæµç¨‹"
  description: "è­˜åˆ¥å’Œåˆ†é¡å°ˆæ¡ˆæª”æ¡ˆï¼Œå€åˆ†è‡¨æ™‚æ¸¬è©¦æª”æ¡ˆå’Œéœ€è¦ä¿ç•™çš„æ ¸å¿ƒæª”æ¡ˆï¼Œç”Ÿæˆæ¸…ç†å»ºè­°å’Œé¢¨éšªè©•ä¼°ã€‚"
  enforcement_level: "strict"
  halt_on_validation_failure: true

inputs:
  project_root: "<auto>"
  task_id: "<optional>"
  classification_scope: "full_project"  # full_project, specific_directories, file_types

execution_hints:
  determinism:
    temperature: 0
    top_p: 0
    top_k: 1
    seed: 42
    response_variability: "none"
  parallelization:
    enabled: true
    max_concurrency: 10
    in_stages:
      file_scanning:
        - "scan_project_structure"
        - "identify_file_types"
        - "analyze_file_sizes"
        - "detect_hidden_files"
      classification_analysis:
        - "analyze_source_code_files"
        - "analyze_test_files"
        - "analyze_config_files"
        - "analyze_documentation_files"
        - "analyze_script_files"
        - "analyze_dependency_relationships"
      risk_assessment:
        - "assess_cleanup_risks"
        - "evaluate_dependency_impacts"
        - "analyze_functional_impacts"
        - "identify_safety_concerns"
  caching:
    enabled: true
    strategy: "content_hash"
    key_paths:
      - "{{project_root}}/src/**/*"
      - "{{project_root}}/test/**/*"
      - "{{project_root}}/docs/**/*"
      - "{{project_root}}/config/**/*"
    expire_on_changes: true
  ordering:
    list_sorting: "stable_lexicographic"
    normalize_paths: true

path_aliases:
  WORKFLOW_FILE: "~/cursor-claude/core/po/workflow/unified-file-classification-workflow.yaml"
  ENFORCEMENT_FILE: "~/cursor-claude/core/po/enforcement/file-classifier-enforcement.md"

classification_criteria:
  must_keep:
    - "source_code_files"
    - "test_files"
    - "config_files"
    - "documentation_files"
    - "script_files"
    - "license_files"
  can_clean:
    - "temporary_files"
    - "build_artifacts"
    - "ide_configs"
    - "backup_files"
    - "cache_files"
  needs_review:
    - "boundary_files"
    - "large_files"
    - "binary_files"
    - "hidden_files"
    - "external_dependencies"

file_type_patterns:
  source_code:
    - "*.js", "*.ts", "*.jsx", "*.tsx"
    - "*.py", "*.java", "*.cpp", "*.c", "*.cs"
    - "*.go", "*.rs", "*.php", "*.rb"
    - "*.swift", "*.kt", "*.scala"
  test_files:
    - "*test*.js", "*test*.ts", "*test*.py"
    - "*spec*.js", "*spec*.ts", "*spec*.py"
    - "test_*.py", "test_*.js", "test_*.ts"
  config_files:
    - "*.json", "*.yaml", "*.yml", "*.toml"
    - "*.env", "*.config", "*.conf"
    - "package.json", "requirements.txt", "pom.xml"
  documentation:
    - "*.md", "*.rst", "*.txt"
    - "*.pdf", "*.doc", "*.docx"
    - "README*", "CHANGELOG*", "LICENSE*"
  scripts:
    - "*.sh", "*.bat", "*.ps1"
    - "Makefile", "Dockerfile", "docker-compose*"
  temporary:
    - "*.tmp", "*.temp", "*.bak", "*.backup"
    - "*.log", "*.out", "*.err"
    - "node_modules/", "dist/", "build/", "target/"

# æª”æ¡ˆæƒæéšæ®µ
file_scanning:
  description: "æƒæå’Œåˆ†æå°ˆæ¡ˆæª”æ¡ˆçµæ§‹"
  steps:
    scan_project_structure:
      description: "æƒæå°ˆæ¡ˆç›®éŒ„çµæ§‹"
      method: "recursive_directory_scan"
      output: "project_structure_map"
      validation:
        min_files: 1
        max_depth: 10
        exclude_patterns:
          - ".git/**"
          - "node_modules/**"
          - "dist/**"
          - "build/**"
          - "target/**"
    
    identify_file_types:
      description: "è­˜åˆ¥æª”æ¡ˆé¡å‹"
      method: "file_extension_analysis"
      input: "project_structure_map"
      output: "file_type_classification"
      validation:
        required_categories: ["source_code", "test_files", "config_files", "documentation"]
    
    analyze_file_sizes:
      description: "åˆ†ææª”æ¡ˆå¤§å°"
      method: "file_size_analysis"
      input: "project_structure_map"
      output: "file_size_statistics"
      validation:
        max_file_size: "100MB"
        large_file_threshold: "10MB"
    
    detect_hidden_files:
      description: "æª¢æ¸¬éš±è—æª”æ¡ˆ"
      method: "hidden_file_detection"
      input: "project_structure_map"
      output: "hidden_files_list"
      validation:
        include_patterns: [".*"]

# åˆ†é¡åˆ†æéšæ®µ
classification_analysis:
  description: "æ·±å…¥åˆ†ææª”æ¡ˆå…§å®¹å’Œä¾è³´é—œä¿‚"
  steps:
    analyze_source_code_files:
      description: "åˆ†ææºä»£ç¢¼æª”æ¡ˆ"
      method: "source_code_analysis"
      input: "file_type_classification"
      output: "source_code_analysis"
      validation:
        min_analysis_depth: "function_level"
        required_metrics: ["complexity", "dependencies", "test_coverage"]
    
    analyze_test_files:
      description: "åˆ†ææ¸¬è©¦æª”æ¡ˆ"
      method: "test_file_analysis"
      input: "file_type_classification"
      output: "test_file_analysis"
      validation:
        required_metrics: ["test_coverage", "test_types", "test_quality"]
    
    analyze_config_files:
      description: "åˆ†æé…ç½®æª”æ¡ˆ"
      method: "config_file_analysis"
      input: "file_type_classification"
      output: "config_file_analysis"
      validation:
        required_metrics: ["environment_specific", "security_implications", "dependencies"]
    
    analyze_documentation_files:
      description: "åˆ†ææ–‡æª”æª”æ¡ˆ"
      method: "documentation_analysis"
      input: "file_type_classification"
      output: "documentation_analysis"
      validation:
        required_metrics: ["completeness", "accuracy", "usefulness"]
    
    analyze_script_files:
      description: "åˆ†æè…³æœ¬æª”æ¡ˆ"
      method: "script_file_analysis"
      input: "file_type_classification"
      output: "script_file_analysis"
      validation:
        required_metrics: ["functionality", "safety", "maintainability"]
    
    analyze_dependency_relationships:
      description: "åˆ†ææª”æ¡ˆä¾è³´é—œä¿‚"
      method: "dependency_analysis"
      input: ["source_code_analysis", "config_file_analysis"]
      output: "dependency_graph"
      validation:
        required_metrics: ["imports", "exports", "circular_dependencies"]

# é¢¨éšªè©•ä¼°éšæ®µ
risk_assessment:
  description: "è©•ä¼°æª”æ¡ˆæ¸…ç†çš„é¢¨éšªå’Œå½±éŸ¿"
  steps:
    assess_cleanup_risks:
      description: "è©•ä¼°æ¸…ç†é¢¨éšª"
      method: "risk_assessment_analysis"
      input: ["file_type_classification", "dependency_graph"]
      output: "cleanup_risk_assessment"
      validation:
        required_risk_levels: ["low", "medium", "high", "critical"]
        required_metrics: ["probability", "impact", "mitigation"]
    
    evaluate_dependency_impacts:
      description: "è©•ä¼°ä¾è³´å½±éŸ¿"
      method: "dependency_impact_analysis"
      input: "dependency_graph"
      output: "dependency_impact_assessment"
      validation:
        required_metrics: ["direct_impact", "indirect_impact", "cascade_effects"]
    
    analyze_functional_impacts:
      description: "åˆ†æåŠŸèƒ½å½±éŸ¿"
      method: "functional_impact_analysis"
      input: ["source_code_analysis", "test_file_analysis"]
      output: "functional_impact_assessment"
      validation:
        required_metrics: ["core_functionality", "optional_features", "integration_points"]
    
    identify_safety_concerns:
      description: "è­˜åˆ¥å®‰å…¨å•é¡Œ"
      method: "safety_analysis"
      input: ["config_file_analysis", "script_file_analysis"]
      output: "safety_concerns"
      validation:
        required_metrics: ["security_risks", "data_protection", "access_control"]

# æ¸…ç†åŸ·è¡Œéšæ®µ
cleanup_execution:
  description: "ç›´æ¥åŸ·è¡Œæª”æ¡ˆæ¸…ç†æ“ä½œ"
  steps:
    execute_cleanup_operations:
      description: "åŸ·è¡Œæ¸…ç†æ“ä½œ"
      method: "cleanup_execution"
      input: ["cleanup_risk_assessment", "dependency_impact_assessment"]
      output: "cleanup_execution_log"
      validation:
        required_sections: ["safe_to_clean", "needs_review", "must_keep", "risk_warnings"]
    
    create_backup_protection:
      description: "å‰µå»ºå‚™ä»½ä¿è­·"
      method: "backup_creation"
      input: "cleanup_risk_assessment"
      output: "backup_files"
      validation:
        required_features: ["safety_checks", "backup_mechanism", "error_handling", "logging"]
    
    generate_execution_report:
      description: "ç”ŸæˆåŸ·è¡Œå ±å‘Š"
      method: "execution_report_generation"
      input: ["cleanup_execution_log", "backup_files", "risk_assessment"]
      output: "execution_report"
      validation:
        required_sections: ["executive_summary", "detailed_analysis", "execution_log", "risk_assessment", "backup_status"]

# èˆ‡å…¶ä»–ä»£ç†çš„å”ä½œ
collaboration:
  with_project_concluder:
    trigger: "parallel_execution_on_conclude"
    integration:
      - "file_classification_results"
      - "cleanup_execution_log"
      - "risk_assessment_summary"
    output_format: "structured_data_for_conclusion_report"
  
  with_knowledge_curator:
    trigger: "after_classification_complete"
    integration:
      - "file_organization_best_practices"
      - "knowledge_management_structure"
    output_format: "knowledge_base_contributions"
  
  with_architecture_documenter:
    trigger: "after_dependency_analysis"
    integration:
      - "file_structure_organization"
      - "module_boundary_definitions"
    output_format: "architecture_documentation_updates"

# è¼¸å‡ºæ ¼å¼å®šç¾©
output_formats:
  classification_report:
    format: "markdown"
    sections:
      - "executive_summary"
      - "file_inventory"
      - "classification_results"
      - "execution_log"
      - "risk_assessment"
      - "backup_status"
  
  cleanup_scripts:
    format: "shell_script"
    features:
      - "safety_checks"
      - "backup_creation"
      - "dry_run_mode"
      - "error_handling"
      - "comprehensive_logging"
  
  risk_assessment:
    format: "structured_data"
    risk_levels:
      - "low": "minimal_impact"
      - "medium": "moderate_impact"
      - "high": "significant_impact"
      - "critical": "severe_impact"

# é©—è­‰å’Œå“è³ªä¿è­‰
validation_and_quality:
  pre_execution_checks:
    - "required_files_available"
    - "permissions_validated"
    - "dependencies_resolved"
  
  execution_monitoring:
    - "progress_tracking"
    - "performance_monitoring"
    - "error_tracking"
  
  post_execution_validation:
    - "classification_accuracy"
    - "completeness_check"
    - "consistency_verification"
  
  quality_metrics:
    - "classification_precision"
    - "risk_assessment_accuracy"
    - "cleanup_safety_score"
    - "execution_efficiency"

# éŒ¯èª¤è™•ç†å’Œæ¢å¾©
error_handling:
  classification_errors:
    action: "log_and_continue"
    fallback: "mark_for_manual_review"
  
  analysis_failures:
    action: "retry_with_reduced_scope"
    fallback: "skip_and_warn"
  
  risk_assessment_failures:
    action: "halt_execution"
    fallback: "generate_manual_review_list"
  
  cleanup_execution_failures:
    action: "halt_execution"
    fallback: "generate_manual_cleanup_guide"

# åŸ·è¡Œé…ç½®
execution_config:
  timeout:
    file_scanning: "5m"
    classification_analysis: "10m"
    risk_assessment: "5m"
    cleanup_execution: "5m"
  
  retry_policy:
    max_retries: 3
    retry_delay: "30s"
    exponential_backoff: true
  
  resource_limits:
    max_memory: "2GB"
    max_cpu_percent: 80
    max_disk_io: "100MB/s"
